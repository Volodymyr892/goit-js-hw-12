{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-funtions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nconst API_KEY = '43948978-860dfecfaa788bc4b5c828749';\nconst BASE_URL = 'https://pixabay.com/api/';\nexport const PER_PAGE = 15;\n\naxios.defaults.baseURL = BASE_URL;\n\nexport const fetchPhotosByQuery = async (query, photosCurrentPage = 1) => {\n  const response = await axios.get('', {\n    params: {\n      key: API_KEY,\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: 'true',\n      per_page: PER_PAGE,\n      page: photosCurrentPage,\n    },\n  });\n\n  return response.data;\n};","\n\nexport const createMarkupItem = images => {\n    \n    return images.map(\n        ({\n            webformatURL,\n            largeImageURL,\n            tags,\n            likes,\n            views,\n            comments,\n            downloads,\n        }) => { return`\n            <li class=\"item-list gallery__item\">\n        <a href=\"${largeImageURL}\" class=\"item-list-link\">\n            <img class=\"item-list-img\"  height=\"152\"\n            width=\"300\" src=\"${webformatURL}\" alt=\"${tags}\">\n        </a>\n        <div class='markup-info'>\n            <div class=\"item-list-info-text\">\n                <h3 class=\"item-list-title\">Likes</h3>\n                    <p class=\"item-list-text\">${likes}</p>\n            </div>\n            <div class=\"item-list-info-text\">\n                <h3 class=\"item-list-title\">Views</h3>\n                    <p class=\"item-list-text\">${views}</p>\n            </div>\n            <div class=\"item-list-info-text\">\n                <h3 class=\"item-list-title\">Comments</h3>\n                    <p class=\"item-list-text\">${comments}</p>\n            </div>\n            <div class=\"item-list-info-text\">\n                <h3 class=\"item-list-title\">Downloads</h3>\n                <p class=\"item-list-text\">${downloads}</p>\n            </div>\n            </div>\n            </li>\n            `\n            }).join(\"\");\n        \n        };","import { fetchPhotosByQuery } from \"./js/pixabay-api\";\nimport { createMarkupItem } from \"./js/render-funtions\";\n\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\n\n\n\nconst searchFormEl = document.querySelector('.js-search-form');\nconst galleryEl = document.querySelector('.js-gallery');\nconst searchFormSubmitBtnEl = document.querySelector('.s-submit-btn');\nconst loaderEl = document.querySelector('.js-loader');\nconst loadMoreBtnEl= document.querySelector('.js-load-more-btn');\n\nlet query = '';\nlet photosCurrentPage = 1;\nlet totalPages = 0; \n\n const lightbox = new SimpleLightbox('ul.list a', {\n  captionsData: 'alt', \n  captionDelay: 250 ,\n  overlayOpacity: 0.8,\n})\n\nconst onSearchFormSubmit = async event =>{\n    event.preventDefault();\n    galleryEl.innerHTML = '';\n    photosCurrentPage = 1;\n\n    loadMoreBtnEl.classList.add('is-hidden'); \n\n    const form= event.currentTarget; \n     query = form.elements.searchKeyword.value.trim();\n    \n    if (query === '') {\n      iziToast.error({\n        message: 'Input field can not be empty',\n        position: 'topRight',\n        timeout: 2000,\n        color: 'red',\n      });\n      form.reset();\n        return;\n      }\n\n  try {\n      searchFormSubmitBtnEl.classList.remove('is-disabled');\n      loaderEl.classList.remove('is-hidden');\n\n      const { hits, totalHits } = await fetchPhotosByQuery(query, photosCurrentPage)\n      if (totalHits === 0) {\n        searchFormSubmitBtnEl.classList.add('is-disabled')\n\n        iziToast.error({\n          message: 'Sorry, there are no images for this query',\n          position: 'topRight',\n          timeout: 2000,\n          color: 'red',\n        });\n        form.reset();\n        loaderEl.classList.add('is-hidden');\n      return;\n      }\n\n      galleryEl.insertAdjacentHTML('beforeend', createMarkupItem(hits));\n      lightbox.refresh()\n      loaderEl.classList.add('is-hidden');\n      searchFormSubmitBtnEl.classList.add('is-disabled');\n\n      totalPages = Math.ceil(totalHits / PER_PAGE);\n      if (totalPages > 1) {\n        // Show laod more btn\n        loadMoreBtnEl.classList.remove('is-hidden');\n      }\n } catch (error){\n        searchFormSubmitBtnEl.classList.add('is-disabled')\n        loaderEl.classList.add('is-hidden');\n        iziToast.error({\n          message: 'Search params is not valid!',\n          position: 'topRight',\n        });\n        form.reset();\n        return;\n      };\n    \n      form.reset();\n    };\n    searchFormEl.addEventListener('submit', onSearchFormSubmit);\n    const smoothScrollOnLoadMore = () => {\n      const lastPhoto = document.querySelector('.gallery__item:last-child');\n      const photosHeight = lastPhoto.getBoundingClientRect().height;\n      // console.log(\" photosHeight:\", photosHeight)\n      const twoPhotosHeight = photosHeight * 2;\n      // console.log(\"twoPhotosHeight:\", twoPhotosHeight)\n      window.scrollBy({\n        top: twoPhotosHeight,\n        left: 0,\n        behavior: 'smooth',\n      });\n    };\n    const onLoadMorePress = async event =>{\n      try {\n        loadMoreBtnEl.classList.add('is-hidden');\n\n        loaderEl.classList.remove('is-hidden');\n    \n        photosCurrentPage += 1;\n    \n        const { hits, totalHits } = await fetchPhotosByQuery(query, photosCurrentPage);\n    \n        galleryEl.insertAdjacentHTML('beforeend', createMarkupItem(hits));\n    \n        lightbox.refresh();\n    \n        smoothScrollOnLoadMore();\n  \n        loaderEl.classList.add('is-hidden');\n    \n        totalPages = Math.ceil(totalHits / PER_PAGE);\n        if (photosCurrentPage < totalPages) {\n\n          loadMoreBtnEl.classList.remove('is-hidden');\n        } else {\n          loadMoreBtnEl.removeEventListener('click', onLoadMorePress);\n          iziToast.info({\n            message: \"We're sorry, but you've reached the end of search results.\",\n            position: 'topRight',\n          });\n          return;\n        }\n      } catch (error) {\n        searchFormSubmitBtnEl.classList.remove('is-disabled');\n  \n        loaderEl.classList.add('is-hidden');\n    \n        iziToast.error({\n          message: 'Search params is not valid!',\n          position: 'topRight',\n        });\n        form.reset();\n        return;\n      }\n    }\n    loadMoreBtnEl.addEventListener('click', onLoadMorePress);\n"],"names":["API_KEY","BASE_URL","PER_PAGE","axios","fetchPhotosByQuery","query","photosCurrentPage","createMarkupItem","images","webformatURL","largeImageURL","tags","likes","views","comments","downloads","searchFormEl","galleryEl","searchFormSubmitBtnEl","loaderEl","loadMoreBtnEl","totalPages","lightbox","SimpleLightbox","onSearchFormSubmit","event","form","iziToast","hits","totalHits","smoothScrollOnLoadMore","twoPhotosHeight","onLoadMorePress"],"mappings":"owBACA,MAAMA,EAAU,qCACVC,EAAW,2BACJC,EAAW,GAExBC,EAAM,SAAS,QAAUF,EAElB,MAAMG,EAAqB,MAAOC,EAAOC,EAAoB,KACjD,MAAMH,EAAM,IAAI,GAAI,CACnC,OAAQ,CACN,IAAKH,EACL,EAAGK,EACH,WAAY,QACZ,YAAa,aACb,WAAY,OACZ,SAAUH,EACV,KAAMI,CACP,CACL,CAAG,GAEe,KClBLC,EAAmBC,GAErBA,EAAO,IACV,CAAC,CACG,aAAAC,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACH,IAAa;AAAA;AAAA,mBAEHL,CAAa;AAAA;AAAA,+BAEDD,CAAY,UAAUE,CAAI;AAAA;AAAA;AAAA;AAAA;AAAA,gDAKTC,CAAK;AAAA;AAAA;AAAA;AAAA,gDAILC,CAAK;AAAA;AAAA;AAAA;AAAA,gDAILC,CAAQ;AAAA;AAAA;AAAA;AAAA,4CAIZC,CAAS;AAAA;AAAA;AAAA;AAAA,aAKxC,EAAE,KAAK,EAAE,EC3BhBC,EAAe,SAAS,cAAc,iBAAiB,EACvDC,EAAY,SAAS,cAAc,aAAa,EAChDC,EAAwB,SAAS,cAAc,eAAe,EAC9DC,EAAW,SAAS,cAAc,YAAY,EAC9CC,EAAe,SAAS,cAAc,mBAAmB,EAE/D,IAAIf,EAAQ,GACRC,EAAoB,EACpBe,EAAa,EAEhB,MAAMC,EAAW,IAAIC,EAAe,YAAa,CAChD,aAAc,MACd,aAAc,IACd,eAAgB,EAClB,CAAC,EAEKC,EAAqB,MAAMC,GAAQ,CACrCA,EAAM,eAAc,EACpBR,EAAU,UAAY,GACtBX,EAAoB,EAEpBc,EAAc,UAAU,IAAI,WAAW,EAEvC,MAAMM,EAAMD,EAAM,cAGlB,GAFCpB,EAAQqB,EAAK,SAAS,cAAc,MAAM,KAAI,EAE3CrB,IAAU,GAAI,CAChBsB,EAAS,MAAM,CACb,QAAS,+BACT,SAAU,WACV,QAAS,IACT,MAAO,KACf,CAAO,EACDD,EAAK,MAAK,EACR,MACD,CAEL,GAAI,CACAR,EAAsB,UAAU,OAAO,aAAa,EACpDC,EAAS,UAAU,OAAO,WAAW,EAErC,KAAM,CAAE,KAAAS,EAAM,UAAAC,CAAS,EAAK,MAAMzB,EAAmBC,EAAOC,CAAiB,EAC7E,GAAIuB,IAAc,EAAG,CACnBX,EAAsB,UAAU,IAAI,aAAa,EAEjDS,EAAS,MAAM,CACb,QAAS,4CACT,SAAU,WACV,QAAS,IACT,MAAO,KACjB,CAAS,EACDD,EAAK,MAAK,EACVP,EAAS,UAAU,IAAI,WAAW,EACpC,MACC,CAEDF,EAAU,mBAAmB,YAAaV,EAAiBqB,CAAI,CAAC,EAChEN,EAAS,QAAS,EAClBH,EAAS,UAAU,IAAI,WAAW,EAClCD,EAAsB,UAAU,IAAI,aAAa,EAEjDG,EAAa,KAAK,KAAKQ,EAAY,QAAQ,EACvCR,EAAa,GAEfD,EAAc,UAAU,OAAO,WAAW,CAEhD,MAAc,CACRF,EAAsB,UAAU,IAAI,aAAa,EACjDC,EAAS,UAAU,IAAI,WAAW,EAClCQ,EAAS,MAAM,CACb,QAAS,8BACT,SAAU,UACpB,CAAS,EACDD,EAAK,MAAK,EACV,MAER,CACMA,EAAK,MAAK,CAChB,EACIV,EAAa,iBAAiB,SAAUQ,CAAkB,EAC1D,MAAMM,EAAyB,IAAM,CAInC,MAAMC,EAHY,SAAS,cAAc,2BAA2B,EACrC,sBAAqB,EAAG,OAEhB,EAEvC,OAAO,SAAS,CACd,IAAKA,EACL,KAAM,EACN,SAAU,QAClB,CAAO,CACP,EACUC,EAAkB,MAAMP,GAAQ,CACpC,GAAI,CACFL,EAAc,UAAU,IAAI,WAAW,EAEvCD,EAAS,UAAU,OAAO,WAAW,EAErCb,GAAqB,EAErB,KAAM,CAAE,KAAAsB,EAAM,UAAAC,CAAW,EAAG,MAAMzB,EAAmBC,EAAOC,CAAiB,EAW7E,GATAW,EAAU,mBAAmB,YAAaV,EAAiBqB,CAAI,CAAC,EAEhEN,EAAS,QAAO,EAEhBQ,IAEAX,EAAS,UAAU,IAAI,WAAW,EAElCE,EAAa,KAAK,KAAKQ,EAAY,QAAQ,EACvCvB,EAAoBe,EAEtBD,EAAc,UAAU,OAAO,WAAW,MACrC,CACLA,EAAc,oBAAoB,QAASY,CAAe,EAC1DL,EAAS,KAAK,CACZ,QAAS,6DACT,SAAU,UACtB,CAAW,EACD,MACD,CACF,MAAe,CACdT,EAAsB,UAAU,OAAO,aAAa,EAEpDC,EAAS,UAAU,IAAI,WAAW,EAElCQ,EAAS,MAAM,CACb,QAAS,8BACT,SAAU,UACpB,CAAS,EACD,KAAK,MAAK,EACV,MACD,CACF,EACDP,EAAc,iBAAiB,QAASY,CAAe"}